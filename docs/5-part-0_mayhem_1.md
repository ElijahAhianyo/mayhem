# Part-0 Mayhem 1

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-Codebase Structure-start--->
## Codebase Structure

<!---Documatic-block-system_architecture-start--->
```mermaid
None
```
<!---Documatic-block-system_architecture-end--->

# #
<!---Documatic-section-Codebase Structure-end--->

<!---Documatic-section-part_0.mayhem_1.publish-start--->
## part-0.mayhem_1.publish

<!---Documatic-section-publish-start--->
```mermaid
flowchart LR
part-0.mayhem_1.publish-->part-0.mayhem_1.PubSubMessage
```

### Object Calls

* part-0.mayhem_1.PubSubMessage

<!---Documatic-block-part_0.mayhem_1.publish-start--->
<details>
	<summary><code>part_0.mayhem_1.publish</code> code snippet</summary>

```python
async def publish(queue, n):
    choices = string.ascii_lowercase + string.digits
    for x in range(1, n + 1):
        host_id = ''.join(random.choices(choices, k=4))
        instance_name = f'cattle-{host_id}'
        msg = PubSubMessage(message_id=x, instance_name=instance_name)
        await queue.put(msg)
        logging.info(f'Published {x} of {n} messages')
    await queue.put(None)
```
</details>
<!---Documatic-block-part_0.mayhem_1.publish-end--->
<!---Documatic-section-publish-end--->

# #
<!---Documatic-section-part_0.mayhem_1.publish-end--->

<!---Documatic-section-part_0.mayhem_1.consume-start--->
## part-0.mayhem_1.consume

<!---Documatic-section-consume-start--->
<!---Documatic-block-part_0.mayhem_1.consume-start--->
<details>
	<summary><code>part_0.mayhem_1.consume</code> code snippet</summary>

```python
async def consume(queue):
    while True:
        msg = await queue.get()
        if msg is None:
            break
        logging.info(f'Consumed {msg}')
        await asyncio.sleep(random.random())
```
</details>
<!---Documatic-block-part_0.mayhem_1.consume-end--->
<!---Documatic-section-consume-end--->

# #
<!---Documatic-section-part_0.mayhem_1.consume-end--->

<!---Documatic-section-part_0.mayhem_1.main-start--->
## part-0.mayhem_1.main

<!---Documatic-section-main-start--->
```mermaid
flowchart LR
part-0.mayhem_1.main-->part-0.mayhem_1.publish
part-0.mayhem_1.publish-->part-0.mayhem_1.PubSubMessage
part-0.mayhem_1.main-->part-0.mayhem_1.consume
```

### Object Calls

* part-0.mayhem_1.publish
* part-0.mayhem_1.consume

<!---Documatic-block-part_0.mayhem_1.main-start--->
<details>
	<summary><code>part_0.mayhem_1.main</code> code snippet</summary>

```python
def main():
    queue = asyncio.Queue()
    asyncio.run(publish(queue, 5))
    asyncio.run(consume(queue))
```
</details>
<!---Documatic-block-part_0.mayhem_1.main-end--->
<!---Documatic-section-main-end--->

# #
<!---Documatic-section-part_0.mayhem_1.main-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)